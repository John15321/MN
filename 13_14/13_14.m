function y=f(x)
    x=2*sin(x)-x^2/10;
end

function [x,fx]=parabolic(x0,x2,maxit,es)
    x1=(x0+x2)/2;
    f0=f(x0); f1=f(x1); f2=f(x2);
    if f1<f0 && f1<f2
        x="error";
        fx="error";
    end
    for i=1:maxit
        x3=(f0*(x1^2-x2^2)+f1*(x2^2-x0^2)+f2*(x0^2-x1^2))/(2*f0*(x1-x2)+2*f1*(x2-x0)+2*f2*(x0-x1));
        f3=f(x3);
        fprintf("%d %g %g %g %g %g %g %g %g\n",i,x0,f0,x1,f1,x2,f2,x3,f3);
        if f3>f1
            if x3<x1
                x2=x1;
                f2=f1;
            else
                x0=x1;
                f0=f1;
            end
            x1=x3;
            f1=f3;
        else
            if x3<x1
                x0=x3;
                f0=f3;
            else
                x2=x3;
                f2=f3;
            end
        end
        if abs((x0-x2)/x1)<es
            break
        end
    end
    x=x1;
    fx=f1;
end


% OUTPUT
% [x,fx]=parabolic(0,4,20,0.001)
% 1 0 0 2 1.41859 4 -3.1136 1.47677 1.77308
% 2 0 0 1.47677 1.77308 2 1.41859 1.37766 1.77302
% 3 1.37766 1.77302 1.47677 1.77308 2 1.41859 1.4275 1.77573
% 4 1.37766 1.77302 1.4275 1.77573 1.47677 1.77308 1.4275 1.77573
% 5 1.4275 1.77573 1.4275 1.77573 1.47677 1.77308 1.42755 1.77573
% 6 1.4275 1.77573 1.42755 1.77573 1.47677 1.77308 1.42755 1.77573
% 7 1.42755 1.77573 1.42755 1.77573 1.47677 1.77308 1.42755 1.77573
% 8 1.42755 1.77573 1.42755 1.77573 1.47677 1.77308 1.42755 1.77573
% 9 1.42755 1.77573 1.42755 1.77573 1.47677 1.77308 1.42755 1.77573
% x =  1.4276
% fx =  1.7757